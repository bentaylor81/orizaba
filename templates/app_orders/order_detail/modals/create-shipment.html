<div id="modal" class="modal large-modal">
    <div id="create-shipment" class="modal-container">
        <div class="modal-top-bar">
            <h1>Create Shipment</h1>
            <span class="modal-close">&times;</span>
        </div>
        <form class="form" method="post" enctype="multipart/form-data">
            <div class="modal-content">
                <div class="modal-col-1">
                    <h2>Delivery Details</h2>
                    {% csrf_token %}
                    <!-- Inputted from order-details.js, based on calculated values below -->
                    <input hidden id="total_price" name="total_price_ex_vat">
                    <input hidden id="total_weight" name="weight">
                    <input hidden name="delivery_country_code" value="{{ order.delivery_country_code }}">
                    <table class="delivery-table" cellpadding="0" cellspacing="0">
                        <tr>
                            <th>First Name:</th>
                            <td><input type="text" name="delivery_firstname" value="{{ order.delivery_firstname }}"></td>
                        </tr>
                        <tr>
                            <th>Last Name:</th>
                            <td><input type="text" name="delivery_lastname" value="{{ order.delivery_lastname }}"></td>
                        </tr>
                        <tr>
                            <th>Address:</th>
                            <td><input type="text" name="delivery_address_1" value="{{ order.delivery_address_1 }}"></td>
                        </tr>
                        <tr>
                            <th></th>
                            <td><input type="text" name="delivery_address_2" value="{{ order.delivery_address_2 }}"></td>
                        </tr>
                        <tr>
                            <th>City:</th>
                            <td><input type="text" name="delivery_city" value="{{ order.delivery_city }}"></td>
                        </tr>
                        <tr>
                            <th>Postcode:</th>
                            <td><input type="text" name="delivery_postcode" value="{{ order.delivery_postcode }}"></td>
                        </tr>
                        <tr>
                            <th>Country:</th>
                            <td><input type="text" name="delivery_country" value="{{ order.delivery_country }}"></td>
                        </tr>
                        <tr>
                            <th>Phone:</th>
                            <td><input type="text" name="delivery_phone" value="{{ order.delivery_phone }}"></td>
                        </tr>
                        <tr>
                            <th>Email:</th>
                            <td><input type="text" name="delivery_email" value="{{ order.delivery_email }}"></td>
                        </tr>
                        {% if order.delivery_country != 'United Kingdom' %}
                        <tr>
                            <th>Tax Number:</th>
                            <td><input type="text" name="delivery_tax_number" value="{{ order.delivery_tax_number }}"></td>
                        </tr>
                        {% endif %}
                    </table>          
                </div>
                <div class="modal-col-2">     
                    <div class="table">
                        <h2>Order Items</h2>
                        <table class="item-table" cellpadding="0" cellspacing="0">
                            <thead>
                                <tr>  
                                    <th>Product Name</th>
                                    <th>Weight</th>
                                    <th>Value</th>
                                    <th>Order Qty</th>
                                    <th>Send Qty</th>       
                                </tr>    
                            </thead>
                            <tbody>                    
                                {% for item in order_items %}           
                                <tr class="{% cycle 'row1' 'row2' %} item-row">
                                    <td class="product-name">{{ item.product_id.product_name }}<input hidden name="orderitem_id" value="{{ item.orderitem_id }}"></td>
                                    <td class="number"><span class="weight">{{ item.product_id.weight|floatformat:2 }}</span>kg</td> 
                                    <td class="number">Â£<span class="price">{{ item.item_price|floatformat:2 }}</span></td>               
                                    <td class="number item-qty">{{ item.item_qty }}</td>
                                    <td class="number send-qty"><input name="send_qty" class="send-qty" type="number" value="{{ item.item_qty }}" min="0" max="{{ item.item_qty }}"></td>
                                    <!-- Hidden fields to calculate the sum of each row -->
                                    <td hidden class="total-item-weight"></td>
                                    <td hidden class="total-item-price"></td>
                                </tr>     
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <div class="shipping-info"> 
                        <div class="weight-value">
                            <h2>Shipping Information</h2>
                            <table class="shipping-table" cellpadding="0" cellspacing="0">
                                <tr>
                                    <th>Total Weight:</th>
                                    <td class="total-weight"><!-- Calculated from JS --></td>
                                </tr>
                                <tr>
                                    <th>Total Value:</th>
                                    <td class="total-price"><!-- Calculated from JS --></td>
                                </tr>
                            </table>
                        </div>
                        <div class="date-method">
                            <div>
                                <label>Despatch Date: <input name="date_sent" type="date" value="{% now 'Y-m-d' %}" min="{% now 'Y-m-d' %}"></label>
                            </div>
                            <div class="delivery-method-div">
                                <label>
                                    Delivery Method:
                                    <select name="service_id">
                                        <option>Select Delivery Method</option>
                                        {% for delivery in delivery_methods %}                       
                                        <option value="{{ delivery.service_id }}">{{ delivery.delivery_method }}</option>
                                        {% endfor %}
                                    </select>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="shipment-actions">
                        <label>Print Picklist:<input name="picklist" type="checkbox" checked></label>
                        <button disabled type="submit" name="add-shipment" class="submitShipment">Create Shipment</button>
                    </div>
                    <div class="confirm-shipment confirmShipment">
                        A Tracked Shipment for this order has already been created. Are you sure you want to proceed?&nbsp;&nbsp;
                        <button type="submit" name="add-shipment">Continue</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>